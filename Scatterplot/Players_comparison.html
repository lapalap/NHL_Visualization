<!DOCTYPE html>
<html>
<title>NHL Vizualization</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
.w3-sidebar a {font-family: "Roboto", sans-serif}
body,h1,h2,h3,h4,h5,h6,.w3-wide {font-family: "Montserrat", sans-serif;}
.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}
.dot {
  stroke: #000;
}
.tooltip {
  position: absolute; 
  text-align: center;           
  background:lightsteelblue;
  width: 300px;
  padding: 4px;   
  border: 4px;    
  border-radius: 8px;     
  pointer-events: none;
}
.column {
  float: left;
  width: 50%;
}
.column_mini_left {
  float: left;
  width: 30%;
}
.column_mini_right {
  float: right;
  width: 70%;
}
/*Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}
.profile_photo_left {visibility: hidden;
  display: block;
  margin-left: auto;
  margin-right: auto;
  border: 1px solid #000000;}

  .profile_photo_right {visibility: hidden;
    display: block;
    margin-left: auto;
    margin-right: auto;
    border: 1px solid #000000;}
    .bar_image {visibility: hidden;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    .chart {
      margin: 10px;
      padding-top: 10px;
    }

    .chart .right {
      stroke: white;
      fill: indianred;
    }

    .chart .left {
      stroke: white;
      fill: steelblue;
    }

    .chart rect:hover {
      fill: #64707d;
    }

    .chart text {
      fill: #24da82;
    }

    .chart text.name {
      fill: black;
    }

    .chart text.title {
      fill: #2216ff;
    }
    .mainBars rect{
      shape-rendering: auto;
      fill-opacity: 0;
      stroke-width: 0.5px;
      stroke: rgb(0, 0, 0);
      stroke-opacity: 0;
    }
    .subBars{
      shape-rendering:crispEdges;
    }
    .edges{
      stroke:none;
      fill-opacity:0.5;
    }
    .header{
      text-anchor:middle;
      font-size:16px;
    }
    .axis path,
    .axis line {
      fill: none;
      stroke: #000;
      shape-rendering: crispEdges;
    }
    .bar { fill: steelblue; }
    line{
      stroke:grey;
    }

  </style>
  <head>
    <title>Rink Plots</title>
    <link rel="stylesheet" type="text/css" href="assets/css/rink-style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script type="text/javascript" src="assets/js/rinkPlot_original.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/selectize.js"></script>
    <script src="js/radarChart.js"></script> 
    <script src="js/index.js"></script>
    <!--     <script src="https://d3js.org/d3.v4.min.js"></script> -->
    <link rel="stylesheet" href="css/normalize.css">
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="http://vizjs.org/viz.v1.1.0.min.js"></script>
    <script type="text/javascript" src="js/promise-polyfill.js"></script>
    <script type="text/javascript" src="js/fetch.umd.js"></script>
    <!--     <script type="text/javascript" src="js/d3.js"></script> -->
    <script type="text/javascript" src="js/crossfilter.js"></script>
    <script type="text/javascript" src="js/dc.js"></script>

    <!-- <link rel="stylesheet" href="css/stylesheet.css"> -->
  </head>
  <body class="w3-content" style="max-width:1500px">
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <!--   <div class="chart" id="full-rink-horz"></div> -->

    <!-- Sidebar/menu -->
    <nav class="w3-sidebar w3-bar-block w3-white w3-collapse w3-top" style="z-index:3;width:250px" id="mySidebar">
      <div class="w3-container w3-display-container w3-padding-16">
        <i onclick="w3_close()" class="fa fa-remove w3-hide-large w3-button w3-display-topright"></i>
        <h3 class="w3-wide"><b>NHL visualization</b></h3>
      </div>
      <div class="w3-padding-64 w3-large w3-text-grey" style="font-weight:bold">
        <a href="../USA%20and%20Canada%20Map/Map_in_CSS_with_line_graph.html" class="w3-bar-item w3-button">Teams summary</a>
        <a href="#" class="w3-bar-item w3-button">Player stats</a>
      </nav>

      <!-- Top menu on small screens -->
      <header class="w3-bar w3-top w3-hide-large w3-black w3-xlarge">
        <div class="w3-bar-item w3-padding-24 w3-wide">NHL visualization</div>
        <a href="javascript:void(0)" class="w3-bar-item w3-button w3-padding-24 w3-right" onclick="w3_open()"><i class="fa fa-bars"></i></a>
      </header>

      <!-- Overlay effect when opening sidebar on small screens -->
      <!-- <div class="w3-overlay w3-hide-large" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div> -->

      <!-- !PAGE CONTENT! -->
      <div class="w3-main" id = "main" style="margin-left:250px">

        <!-- Push down content on small screens -->
        <div class="w3-hide-large" style="margin-top:83px"></div>

        <!-- Top header -->
        <header class="w3-container w3-xlarge">
          <p class="w3-left" style="font-size:160%;">Players side-by-side comparison</p>
        </header>
        <div  class="w3-display-container w3-container" id = "general">
          <div class="control-group" style="margin-top:30px">
            <label for="select-player" style="text-align:center;">Players:</label>
            <select id="select-player" name="player[]" multiple class="demo-default" style="width:50%" placeholder="Select a player..." style="text-align:center;">
              <option value="">Select a player...</option>
              <option value=8471214>Alex Ovechkin</option>
              <option value=8471675>Sidney Crosby</option>
              <option value=8474141>Patrick Kane</option>
              <option value=8470794>Joe Pavelski</option>
              <option value=8475765>Vladimir Tarasenko</option>
              <option value=8475166>John Tavares</option>
              <option value=8475794>Tyler Seguin</option>
              <option value=8473994>Jamie Benn</option>
              <option value=8471215>Evgeni Malkin</option>
              <option value=8470621>Corey Perry</option>
              <option value=8473419>Brad Marchand</option>
              <option value=8473604>Jonathan Toews</option>
              <option value=8474564>Steven Stamkos</option>
              <option value=8473548>Phil Kessel</option>
              <option value=8474053>Logan Couture</option>
              <option value=8474157>Max Pacioretty</option>
              <option value=8476453>Nikita Kucherov</option>
              <option value=8471707>James Neal</option>
              <option value=8470604>Jeff Carter</option>
              <option value=8466139>Patrick Marleau</option>
              <option value=8470638>Patrice Bergeron</option>
              <option value=8470041>Rick Nash</option>
              <option value=8471698>T.J. Oshie</option>
              <option value=8474190>Wayne Simmonds</option>
              <option value=8470610>Zach Parise</option>
              <option value=8474037>James van Riemsdyk</option>
              <option value=8471218>Blake Wheeler</option>
              <option value=8471685>Anze Kopitar</option>
              <option value=8475168>Matt Duchene</option>
              <option value=8475784>Jeff Skinner</option>
            </select>
          </div>

          <div class="row" id="row">
            <div class="column" id="column_left" style="text-align:center;">
              <img id ="left_profile_photo" class="profile_photo_left" src="../data/Players/Images/8475784.jpg" width="150" style="text-align:center;">
              <p id="name_left_column" class="w3-large" style="color: black;"></p>
              <div id = "description_left" style="text-align:center;"></div>
              <p id="scatter_text1" class="w3-large" style="color: black;"></p>
              <div id = "field_left" style="text-align:center;"></div>
            </div>
            <div class="column" id="column_right" style="text-align:center;">
              <img id ="right_profile_photo" class="profile_photo_right" src="../data/Players/Images/8475784.jpg" width="150" style="text-align:center;">
              <p id="name_right_column" class="w3-large" style="color: black;"></p>
              <div id = "description_right" style="text-align:center;"></div>
              <p id="scatter_text2" class="w3-large" style="color: black;"></p>
              <div id = "field_right" style="text-align:center;"></div>
            </div>
          </div>
          <p id="dist_text" class="w3-large" style="color: black;"></p>
          <div class = "row" id = "row2">
            <div class="column" id="column_left2" style="text-align:center;">
              <img id ="left_bar" class="bar_image" src="../data/Bars/8475784.png" width="600" style="text-align:center;">
            </div>
            <div class="column" id="column_right2" style="text-align:center;">
              <img id ="right_bar" class="bar_image" src="../data/Bars/8475784.png" width="600" style="text-align:center;">
            </div>

          </div>


          <script>
            var season = $('#select-season').selectize({
              create: true,
              dropdownParent: 'body'
            });

            console.log(season.value);



            var selection = $('#select-player').selectize({
              maxItems: 2,
              delimiter: ',',
              onChange: function(value) {
             // alert(value);

             var dict = {
               8471214 : 'Alex Ovechkin',
               8471675 : 'Sidney Crosby',
               8474141 : 'Patrick Kane',
               8470794 : 'Joe Pavelski',
               8475765 : 'Vladimir Tarasenko',
               8475166 : 'John Tavares',
               8475794 : 'Tyler Seguin',
               8473994 : 'Jamie Benn',
               8471215 : 'Evgeni Malkin',
               8470621 : 'Corey Perry',
               8473419 : 'Brad Marchand',
               8473604 : 'Jonathan Toews',
               8474564 : 'Steven Stamkos',
               8473548 : 'Phil Kessel',
               8474053 : 'Logan Couture',
               8474157 : 'Max Pacioretty',
               8476453 : 'Nikita Kucherov',
               8471707 : 'James Neal',
               8470604 : 'Jeff Carter',
               8466139 : 'Patrick Marleau',
               8470638 : 'Patrice Bergeron',
               8470041 : 'Rick Nash',
               8471698 : 'T.J. Oshie',
               8474190 : 'Wayne Simmonds',
               8470610 : 'Zach Parise',
               8474037 : 'James van Riemsdyk',
               8471218 : 'Blake Wheeler',
               8471685 : 'Anze Kopitar',
               8475168 : 'Matt Duchene',
               8475784 : 'Jeff Skinner'};

               if (value[1] != null) {

                 document.getElementById('name_left_column').innerHTML = dict[value[0]];
                 document.getElementById('name_right_column').innerHTML = dict[value[1]];

                 document.getElementById('scatter_text1').innerHTML = "Scatterplot of position of goals";
                 document.getElementById('scatter_text2').innerHTML = "Scatterplot of position of goals";
                 document.getElementById('dist_text').innerHTML = "Distribution of distances of goals";

                 d3.select("svg").remove();
                 d3.select("svg").remove();

                 var imgReplace_left = document.getElementById("left_profile_photo");
                 imgReplace_left.src = "../data/Players/Images/"+value[0]+".jpg";
                 imgReplace_left.style.visibility = "visible";
                 imgReplace_left.style.borderRadius = '50%';

                 var imgReplace_right = document.getElementById("right_profile_photo");
                 imgReplace_right.src = "../data/Players/Images/"+value[1]+".jpg";
                 imgReplace_right.style.visibility = "visible";
                 imgReplace_right.style.borderRadius = '50%';

                 var imgReplace_bar_left = document.getElementById("left_bar");
                 imgReplace_bar_left.src = "../data/Bars/"+value[0]+".png";
                 imgReplace_bar_left.style.visibility = "visible";

                 var imgReplace_bar_right = document.getElementById("right_bar");
                 imgReplace_bar_right.src = "../data/Bars/"+value[1]+".png";
                 imgReplace_bar_right.style.visibility = "visible";

                 var width = document.getElementById('column_left').offsetWidth*0.7;


                 var chart = function(svg){
                  var fullHorzPlot = new RINK_MAP({parent: svg, fullRink: false, desiredWidth: width, horizontal: false});
                  fullHorzPlot();
                  svg_left.attr("w3-container", "chart");
                  return svg.node();
                }

                if (svg_left == null){
                 var svg_left = d3.select("#field_left").append("svg")
                 .attr("width", width)
                 .attr("height", width*1.25);

                 var svg_right = d3.select("#field_right").append("svg")
                 .attr("width", width)
                 .attr("height", width*1.25);

                 chart(svg_left);
                 chart(svg_right);
               }
              // setup x 
              var xValue = function(d) { return d.st_y;}, // data -> value
                  xScale = d3.scale.linear().range([0, width]), // value -> display
                  xMap = function(d) { return xScale(xValue(d));}, // data -> display
                  xAxis = d3.svg.axis().scale(xScale).orient("bottom");

              // setup y
              var yValue = function(d) { return d.st_x+100;}, // data -> value
                  yScale = d3.scale.linear().range([width*1.25, 0]), // value -> display
                  yMap = function(d) { return yScale(yValue(d));}, // data -> display
                  yAxis = d3.svg.axis().scale(yScale).orient("left");

              // setup fill color
              var cValue = function(d) { return d.rink_side;},
              color = d3.scale.category10();

              // add the tooltip area to the webpage
              var tooltip = d3.select("body").append("div")
              .attr("class", "tooltip")
              .style("opacity", 0);


              d3.csv("../data/Players/"+value[0]+".csv", function(error, data) {

                yScale.domain([100, 0]);
                xScale.domain([-42.5, 42.5]);

                // draw dots
                svg_left.select("g").selectAll(".dot")
                .data(data)
                .enter()
                .append("circle")
                .attr("class", "dot")
                .attr("r", 4)
                .attr("cx", xMap)
                .attr("cy", yMap)
                .style("fill", "blue")
                .style("opacity", .6)
                .on("mouseover", function(d) {
                  tooltip.transition()
                  .duration(200)
                  .style("opacity", .9);
                  tooltip.html(d.description+ ', ' + d.dateTime.substring(0, 10))
                  .style("left", (d3.event.pageX + 5) + "px")
                  .style("top", (d3.event.pageY - 28) + "px");
                })
                .on("mouseout", function(d) {
                  tooltip.transition()
                  .duration(500)
                  .style("opacity", 0);
                });
              });

            }

            d3.csv("../data/Players/"+value[1]+".csv", function(error, data) {

              yScale.domain([100, 0]);
              xScale.domain([-42.5, 42.5]);

                // draw dots
                svg_right.select("g").selectAll(".dot")
                .data(data)
                .enter()
                .append("circle")
                .attr("class", "dot")
                .attr("r", 4)
                .attr("cx", xMap)
                .attr("cy", yMap)
                .style("fill", "blue")
                .style("opacity", .6)
                .on("mouseover", function(d) {
                  tooltip.transition()
                  .duration(200)
                  .style("opacity", .9);
                  tooltip.html(d.description+ ', ' + d.dateTime.substring(0, 10))
                  .style("left", (d3.event.pageX + 5) + "px")
                  .style("top", (d3.event.pageY - 28) + "px");
                })
                .on("mouseout", function(d) {
                  tooltip.transition()
                  .duration(500)
                  .style("opacity", 0);
                })
                .on("mo");
              });
        // d3.csv("../data/Players/players.csv", function(error, data) {
        //   var

        // });

      }
    });
  </script>

<!-- <script>

// set the dimensions and margins of the graph
var margin = {top: 20, right: 20, bottom: 30, left: 40},
    width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

// set the ranges
var x = d3.scaleBand()
          .rangeRound([0, width])
          .paddingInner(0.1);
var y = d3.scaleLinear()
          .rangeRound([height, 0]);
          
// append the svg object to the body of the page
// append a 'group' element to 'svg'
// moves the 'group' element to the top left margin
var svg = d3.select("#bar_left").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", 
          "translate(" + margin.left + "," + margin.top + ")");

// get the data
d3.csv("../data/Bars/8471214.csv", function(error, data) {
  if (error) throw error;

  // format the data
  data.forEach(function(d) {
    d.sales = +d.sales;
  });

  // Scale the range of the data in the domains
  x.domain(data.map(function(d) { return d.salesperson; }));
  y.domain([0, d3.max(data, function(d) { return d.sales; })]);

  // append the rectangles for the bar chart
  svg.selectAll(".bar")
      .data(data)
    .enter().append("rect")
      .attr("class", "bar")
      .attr("x", function(d) { return x(d.salesperson); })
      .attr("width", x.bandwidth())
      .attr("y", function(d) { return y(d.sales); })
      .attr("height", function(d) { return height - y(d.sales); });

  // add the x Axis
  svg.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x));

  // add the y Axis
  svg.append("g")
      .call(d3.axisLeft(y));

});

</script> -->



<script>

// Accordion 
function myAccFunc() {
  var x = document.getElementById("demoAcc");
  if (x.className.indexOf("w3-show") == -1) {
    x.className += " w3-show";
  } else {
    x.className = x.className.replace(" w3-show", "");
  }
}




// Open and close sidebar
function w3_open() {
  document.getElementById("mySidebar").style.display = "block";
  document.getElementById("myOverlay").style.display = "block";
}

function w3_close() {
  document.getElementById("mySidebar").style.display = "none";
  document.getElementById("myOverlay").style.display = "none";
}
</script>

</body>
</html>

